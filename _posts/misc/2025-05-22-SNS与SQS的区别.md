---
layout: post
title: SNS与SQS的区别
date: 2025-05-22
categories: message-queue
---

本文讨论在抽象层面上 SNS 与 SQS 的区别，不涉及具体实现细节。但主要参考的是 AWS 的 SNS 和 SQS 服务。

## SQS（Simple Queue Service）

SQS 是一种点对点的数据处理模型，通常被称为消息队列。
SQS 的一个典型特征是：**一条消息只能被一个消费者消费**。

- **生产者（Producer）**：发送消息到队列
- **消费者（Consumer）**：从队列中拉取消息进行处理

SQS 的主要特点：

- **数据交付保证**：在消费者读取数据后，该数据将在一段时间内对其他消费者不可见，直到消费者手动确认数据已被成功处理
- **持久化和重试机制**：对于未被确认消费的消息，系统会再次投递，直到消息过期或达到最大重试次数
- **可能存在数据重复投递**：消费者需要实现幂等处理以应对这种情况
- **可能提供顺序保证**：先到达的消息先被消费
- **基于轮询机制**：消费者需要主动轮询消息（但 AWS 的 Lambda 等服务可以被 SQS 触发，无需维护一个持续运行的服务，或者说 AWS 为我们提供了这样的服务）

## SNS（Simple Notification Service）

SNS 是一种一对多的数据处理模型，也称为发布订阅模型。

SNS 的主要特点：

1. **无确认机制**：只有推送失败时才会重试。例如，当 SNS 推送消息到 Lambda 时，即使 Lambda 启动成功但因代码错误导致消息未被处理并异常退出，在 SNS 看来，这次推送仍被视为成功
2. **主动推送模式**：SNS 主动将消息推送给所有订阅者

## 总结

- **SQS 的核心特征**：一对一通信和可靠性，适用于异步处理、负载均衡和系统间解耦
- **SNS 的核心特征**：一对多通信，适用于广播通知、日志推送和多服务解耦
- **组合使用**：将 SNS 的消费者设置为 SQS，可以实现可靠的消息传递和重试机制

## 与 SNS 和 SQS 类似的实现

- Redis
- Kafka
- RabbitMQ
- RocketMQ
