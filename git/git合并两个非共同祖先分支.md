---
Title: git合并两个非共同祖先分支
Date: 2023-09-03 11:00:00
---

#  前情提要

在工作中遇到这样一个情况：一个git仓库的两个分支中分别开发一个工具，在开发完成后，需要将两个工具合并到一个分支中，但是这两个工具的分支没有共同的祖先分支

首选需要说明的是：一个git仓库干两件事情，是不太规范的（或许也没有这样的规范，但是比较ugly）。

但是事情已经发生了，就需要解决。以下是解决方案

# cherry pick
使用cherrypick命令将两个分支的提交记录合并到一个分支中。
建议使用jetbrains系IDE，全选git提交记录，然后右键cherrypick，简单易操作，也不会出错。

需要注意的是：
1. cherrypick命令会将提交记录的hash值改变，因此需要在cherrypick之前，将两个分支的提交记录备份一下，以便出现错误时，可以回退到原来的状态
2. cherrypick无法简单处理merge的情况，如果两个分支中有merge的情况，需要手动切checkout到merge的commit，然后进行提交，即可让代码与merge之后的代码保持一致
3. 如果两个分支的记录中存在文件名相同，但是内容不同的文件，即使最后的状态中已经重命名或者删除，cherrypick会报错，因此，建议在合并之前，将两个分支都放到一个子文件夹中，然后再进行cherrypick合并，最后手动从文件夹中提取文件
# rebase

取一个分支为基准，将另一个分支的提交记录rebase到基准分支上即可，这样就可以将两个分支的提交记录合并到一个分支上。

需要注意的是：
1. 记得备份
2. 同名文件也会出现冲突，用子文件夹的方法可解